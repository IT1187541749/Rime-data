

require "import"

local å‚æ•° = (...)

local è„šæœ¬ç›®å½•=tostring(service.getLuaExtDir("script"))
local è„šæœ¬è·¯å¾„=debug.getinfo(1,"S").source:sub(2)--è·å–Luaè„šæœ¬çš„å®Œæ•´è·¯å¾„

local çº¯è„šæœ¬å=File(è„šæœ¬è·¯å¾„).getName()
local ç›®å½•=string.sub(è„šæœ¬è·¯å¾„,1,#è„šæœ¬è·¯å¾„-#çº¯è„šæœ¬å)


local è„šæœ¬ç›¸å¯¹è·¯å¾„=string.sub(è„šæœ¬è·¯å¾„,#è„šæœ¬ç›®å½•+1)

local  æ˜Ÿåº§ç»„={"â™ˆç™½ç¾Šåº§","â™‰é‡‘ç‰›åº§","â™ŠåŒå­åº§","â™Œå·¨èŸ¹åº§","â™Œç‹®å­åº§","â™å¤„å¥³åº§","â™å¤©ç§¤åº§","â™å¤©èåº§","â™‘å°„æ‰‹åº§","â™“æ‘©ç¾¯åº§","â™’æ°´ç“¶åº§","â™åŒé±¼åº§"}

local  æ˜Ÿåº§æ‹¼éŸ³={"baiyang","jinniu","shuangzi","juxie","shizi","chunv","tiancheng","tianxie","sheshou","mojie","shuiping","shuangyu"}


local ç¼–å·=0
local æ—¥æœŸ=tostring(os.date("%Y%m%d"))
if string.find(å‚æ•°,"ã€ã€")!=nil && string.find(å‚æ•°,"ã€‘ã€‘")!=nil then
 ç¼–å·=tonumber(string.sub(å‚æ•°,7,#å‚æ•°-6))
 --print(æ—¥æœŸ)
end--if string.find(å‚æ•°

if ç¼–å·!=0 then
local äº‘è¾“å…¥å†…å®¹="https://m.smxs.com/xingzuoriyun/"..æ˜Ÿåº§æ‹¼éŸ³[ç¼–å·].."/date/"..æ—¥æœŸ..".html"
local å†…å®¹=""
local å†…å®¹ç»„={}
Http.get(äº‘è¾“å…¥å†…å®¹,nil,"utf-8",nil,function(a,b)
 if a==200 then 
  local å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">")
  å†…å®¹="â–‚â–‚â–‚â–‚â–‚â–‚â–‚â–‚\n"..æ˜Ÿåº§ç»„[ç¼–å·].."ä»Šæ—¥è¿åŠ¿: \nâ˜€"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+32)..string.sub(b,å¼€å§‹ä½ç½®+40,å¼€å§‹ä½ç½®+54)--æ•´ä½“è¿åŠ¿
  
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸ’—"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+32)..string.sub(b,å¼€å§‹ä½ç½®+40,å¼€å§‹ä½ç½®+54)--çˆ±æƒ…è¿åŠ¿
  
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸ“"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+32)..string.sub(b,å¼€å§‹ä½ç½®+40,å¼€å§‹ä½ç½®+54)--äº‹ä¸šå­¦ä¸š
  
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸ’°"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+32)..string.sub(b,å¼€å§‹ä½ç½®+40,å¼€å§‹ä½ç½®+54)--è´¢å¯Œè¿åŠ¿
  
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸ"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+32)..string.sub(b,å¼€å§‹ä½ç½®+40,å¼€å§‹ä½ç½®+45)--å¹¸è¿é¢œè‰²
  
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸ°"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+32)..string.sub(b,å¼€å§‹ä½ç½®+40,å¼€å§‹ä½ç½®+40)--å¹¸è¿æ•°å­—
  
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nâ­"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+32)..string.sub(b,å¼€å§‹ä½ç½®+40,å¼€å§‹ä½ç½®+48)--é€Ÿé…æ˜Ÿåº§
  
  å¼€å§‹ä½ç½®=string.find(b,"span class=\"blue\">",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸ“"..string.sub(b,å¼€å§‹ä½ç½®+18,å¼€å§‹ä½ç½®+26)
  å¼€å§‹ä½ç½®=string.find(b,"</span>",å¼€å§‹ä½ç½®+1)
  local ç»“æŸä½ç½®=string.find(b,"</p>",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹..string.sub(b,å¼€å§‹ä½ç½®+7,ç»“æŸä½ç½®-1)--çŸ­è¯„
  
  å¼€å§‹ä½ç½®=string.find(b,"çˆ±æƒ…è¿åŠ¿",å¼€å§‹ä½ç½®+1)
  å¼€å§‹ä½ç½®=string.find(b,"<p>",å¼€å§‹ä½ç½®+1)
  local ç»“æŸä½ç½®=string.find(b,"</p>",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸ’çˆ±æƒ…è¿åŠ¿: "..string.sub(b,å¼€å§‹ä½ç½®+3,ç»“æŸä½ç½®-1)
  
  å¼€å§‹ä½ç½®=string.find(b,"å¥åº·è¿åŠ¿",å¼€å§‹ä½ç½®+1)
  å¼€å§‹ä½ç½®=string.find(b,"<p>",å¼€å§‹ä½ç½®+1)
  local ç»“æŸä½ç½®=string.find(b,"</p>",å¼€å§‹ä½ç½®+1)
  å†…å®¹=å†…å®¹.."\nğŸƒå¥åº·è¿åŠ¿: "..string.sub(b,å¼€å§‹ä½ç½®+3,ç»“æŸä½ç½®-1)
  
  
  å†…å®¹=string.gsub(å†…å®¹,"<br>","\n")
  å†…å®¹=string.gsub(å†…å®¹,"&nbsp;"," ")
  å†…å®¹=string.gsub(å†…å®¹,"<.->","")
  å†…å®¹=string.gsub(å†…å®¹,"&ldquo;","\"")
  å†…å®¹=string.gsub(å†…å®¹,"&rdquo;","\"")
  --å†…å®¹=string.gsub(å†…å®¹,"&nbsp"," ")
 --print(å†…å®¹)
 task(100,function()
  service.addCompositions({å†…å®¹}) end)
 else
 print("å¯¹ä¸èµ·,ä½ çš„ç½‘ç»œä¼¼ä¹å‡ºç°äº†ç‚¹é—®é¢˜")
 end
 end)


end--if æ˜Ÿåº§


local é»˜è®¤å®½åº¦=25
local é»˜è®¤é«˜åº¦=40





local æŒ‰é”®ç»„={}
 --ç¬¬1è¡Œ
 local æŒ‰é”®={}
 æŒ‰é”®["width"]=100
-- æŒ‰é”®["height"]=25
 æŒ‰é”®["click"]=""
 æŒ‰é”®["label"]="ä»Šæ—¥æ˜Ÿåº§è¿åŠ¿"
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®

for i=1,#æ˜Ÿåº§ç»„ do
 local æŒ‰é”®={}
 æŒ‰é”®["click"]={label="", send="function",command= è„šæœ¬ç›¸å¯¹è·¯å¾„,option= "ã€ã€"..i.."ã€‘ã€‘"}
 æŒ‰é”®["label"]=æ˜Ÿåº§ç»„[i]
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®
 
 
end


import "script.åŒ….å…¶å®ƒ.ä¸»é”®ç›˜"
 local æŒ‰é”®=ä¸»é”®ç›˜()
 æŒ‰é”®["width"]=100
 æŒ‰é”®ç»„[#æŒ‰é”®ç»„+1]=æŒ‰é”®

service.setKeyboard{
  name="ä»Šæ—¥æ˜Ÿåº§è¿åŠ¿",
  ascii_mode=0,
  width=é»˜è®¤å®½åº¦,
  height=é»˜è®¤é«˜åº¦,
  keys=æŒ‰é”®ç»„
  }


